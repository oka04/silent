//*****************************************************************************
//
// ＢＧＭ管理
//
// BGMManage.h
//
// K_Yamaoka
//
// 2011/11/14
//
// 2014/11/28 エラーメッセージを追加
//
//*****************************************************************************

#pragma once

//DirectShowを使うと色々な警告が出るため、警告が出ないよう設定しておく
#pragma warning(disable : 4995)

#include <dshow.h>

#include <string>

#include "..\\Exception\\DxSystemException.h"

class BGMManage
{
public:

	//=============================================================================
	// メンバの初期化（コンストラクタ）
	//=============================================================================
	BGMManage();

	//=============================================================================
	// デストラクタ
	//=============================================================================
	~BGMManage();

	//=============================================================================
	// ＢＧＭ管理の初期化
	//=============================================================================
	void Initializie();

	//=============================================================================
	// DirectShow関連の初期化およびメディアファイルの読み込み
	// 引　数：strFileName メディアファイル名（mp3）
	//=============================================================================
	void AddBGM(std::string strFileName);

	//=============================================================================
	// DirectShow関連領域の解放
	//=============================================================================
	void ReleaseBGM();

	//=============================================================================
	// メディアの再生
	// 戻り値：成功 true  失敗 false
	//=============================================================================
	void PlayBGM();

	//=============================================================================
	// メディアの停止
	//=============================================================================
	void StopBGM();

	//=============================================================================
	// ループ再生
	//=============================================================================
	void LoopBGM();

private:

	//グラフビルダー
	IGraphBuilder* m_pGraphBuilder;

	//メディアコントロール用
	IMediaControl* m_pMediaControl;

	//イベント取得用
	IMediaEvent*   m_pMediaEvent;

	//巻き戻し用
	IMediaSeeking* m_pMediaSeeking;

	//-----------------------------------------------------------------------------
	// 再生中チェック
	// 戻り値：再生中 true  それ以外 false
	//-----------------------------------------------------------------------------
	bool IsPlaying();

	//-----------------------------------------------------------------------------
	// メディアの巻き戻し
	//-----------------------------------------------------------------------------
	void Rewind();
};